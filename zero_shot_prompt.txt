function toSnakeCase(text) {
  return text
    .replace(/\s+/g, ' ')                // Replace multiple spaces with a single space
    .trim()                              // Remove leading/trailing spaces
    .replace(/([a-z])([A-Z])/g, '$1_$2') // Add _ between camelCase words
    .replace(/[\s\-]+/g, '_')            // Replace spaces and hyphens with _
    .toLowerCase();                      // Convert to lowercase
}

// Example usage:
// toSnakeCase('Convert Text To Snake Case') => 'convert_text_to_snake_case'
// toSnakeCase('convertTextToSnakeCase') => 'convert_text_to_snake_case'
// toSnakeCase('convert-text to snake case') => 'convert_text_to_snake_case'